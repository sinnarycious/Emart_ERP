<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="sale">

	<select id="findMonday" parameterType="string" resultType="hashmap" >
		SELECT NEXT_DAY(TO_DATE(#{sqlDate})-14, '월') "LAST_WEEK"
		FROM DUAL;
	</select>


<resultMap type="sale" id="saleMap">
		<result column="SALE_NO" property="saleNo" />
		<result column="SALE_COUNT" property="saleCount" />
		<result column="SALE_PRICE" property="salePrice" />
		<result column="SALE_DATE" property="saleDate" />
		<result column="SALE_CAT_NO" property="saleCatNo" />
		<result column="SALE_NAME" property="saleName" />
		<result column="USER_NO" property="userNo" />
		<result column="PRO_NO" property="proNo" />
	</resultMap>
	
	<select id="selectSaleList" resultMap="saleMap">
		SELECT S.*,P.PRO_NO FROM SALE S,PRODUCT P
		WHERE SALE_NAME = PRO_NAME
		ORDER BY SALE_NO DESC
	</select>
	
	<select id="selectSaleTotalContents" resultType="_int">
		SELECT COUNT(*) FROM SALE
	</select>
	
	<!-- 검색 기능 -->
	<select id="searchInfo" parameterType="sale" resultMap="saleMap">
		SELECT S.*, PRO_NO
		FROM PRODUCT P, SALE S
		WHERE SALE_NAME = PRO_NAME
			<if test="saleName !=null">
				AND SALE_NAME LIKE '%' || #{ saleName } || '%'
			</if>
			<if test="proNo != 0">
				AND PRO_NO = #{ proNo }
			</if>
			<if test="saleDate1 !=null and saleDate2 = null">
				AND SALE_DATE = #{ saleDate1 }
			</if>
			<if test="saleDate1 !=null and saleDate2 !=null">
				AND SALE_DATE BETWEEN #{ saleDate1 } AND #{ saleDate2 }
			</if>
		
	</select>
	

</mapper>